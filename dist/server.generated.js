module.exports=function(e){var t={};function a(r){if(t[r])return t[r].exports;var n=t[r]={i:r,l:!1,exports:{}};return e[r].call(n.exports,n,n.exports,a),n.l=!0,n.exports}return a.m=e,a.c=t,a.d=function(e,t,r){a.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},a.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},a.t=function(e,t){if(1&t&&(e=a(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(a.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)a.d(r,n,function(t){return e[t]}.bind(null,n));return r},a.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return a.d(t,"a",t),t},a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},a.p="/dist/",a(a.s=74)}([function(e,t){e.exports=require("react")},function(e,t){e.exports=require("react-router-dom")},function(e,t){e.exports=require("@material-ui/core/Button")},function(e,t){e.exports=require("@material-ui/core/Typography")},function(e,t){e.exports=require("@material-ui/core/styles")},function(e,t){e.exports=require("@material-ui/core/TextField")},function(e,t){e.exports=require("@material-ui/core/IconButton")},function(e,t){e.exports=require("mongoose")},function(e,t){e.exports=require("@material-ui/core/Card")},function(e,t){e.exports=require("@material-ui/core/ListItem")},function(e,t){e.exports=require("@material-ui/core/ListItemText")},function(e,t){e.exports=require("@material-ui/core/List")},function(e,t){e.exports=require("@material-ui/core/Divider")},function(e,t){e.exports=require("prop-types")},function(e,t){e.exports=require("@material-ui/core/ListItemAvatar")},function(e,t){e.exports=require("@material-ui/core/Avatar")},function(e,t){e.exports=require("express")},function(e,t){e.exports=require("@material-ui/core/CardActions")},function(e,t){e.exports=require("@material-ui/core/Dialog")},function(e,t){e.exports=require("@material-ui/core/DialogActions")},function(e,t){e.exports=require("@material-ui/core/DialogContent")},function(e,t){e.exports=require("@material-ui/core/DialogTitle")},function(e,t){e.exports=require("@material-ui/core/CardHeader")},function(e,t){e.exports=require("@material-ui/core/CardContent")},function(e,t){e.exports=require("@material-ui/core/ListItemSecondaryAction")},function(e,t){e.exports=require("@material-ui/core/CardMedia")},function(e,t){e.exports=require("@material-ui/core/Paper")},function(e,t){e.exports=require("@material-ui/core/DialogContentText")},function(e,t){e.exports=require("@material-ui/icons/Delete")},function(e,t){e.exports=require("@material-ui/core/Icon")},function(e,t){e.exports=require("@material-ui/core/GridList")},function(e,t){e.exports=require("@material-ui/core/GridListTile")},function(e,t){e.exports=require("@material-ui/core/GridListTileBar")},function(e,t){e.exports=require("@material-ui/icons/Person")},function(e,t){e.exports=require("@material-ui/icons/Visibility")},function(e,t){e.exports=require("@material-ui/icons/VisibilityOff")},function(e,t){e.exports=require("@material-ui/core/InputAdornment")},function(e,t){e.exports=require("@material-ui/icons/Edit")},function(e,t){e.exports=require("@material-ui/icons/AddPhotoAlternate")},function(e,t){e.exports=require("lodash/extend")},function(e,t,a){"use strict";a.r(t),a.d(t,"signin",(function(){return r})),a.d(t,"signout",(function(){return n}));const r=async e=>{try{let t=await fetch("/auth/signin",{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},credentials:"include",body:JSON.stringify(e)});const a=await t.json();return console.log(a),a}catch(e){console.log(e)}},n=async()=>{try{let e=await fetch("/auth/signout/",{method:"GET"});return await e.json()}catch(e){console.log(e)}}},function(e,t){e.exports=require("@material-ui/icons/VerifiedUser")},function(e,t){e.exports=require("body-parser")},function(e,t){e.exports=require("@material-ui/icons/ArrowUpward")},function(e,t){e.exports=require("@material-ui/icons/CheckCircle")},function(e,t){e.exports=require("@material-ui/styles")},function(e,t){e.exports=require("fs")},function(e,t){e.exports=require("formidable")},function(e,t){e.exports=require("path")},function(e,t){e.exports=require("cookie-parser")},function(e,t){e.exports=require("compression")},function(e,t){e.exports=require("cors")},function(e,t){e.exports=require("helmet")},function(e,t){e.exports=require("react-dom/server")},function(e,t){e.exports=require("react-router-dom/StaticRouter")},function(e,t){e.exports=require("@material-ui/core/AppBar")},function(e,t){e.exports=require("@material-ui/core/Toolbar")},function(e,t){e.exports=require("@material-ui/icons/Home")},function(e,t){e.exports=require("@material-ui/icons/LocalLibrary")},function(e,t){e.exports=require("@material-ui/icons/DonutLarge")},function(e,t){e.exports=require("@material-ui/icons/ArrowForward")},function(e,t){e.exports=require("@material-ui/core/FormControlLabel")},function(e,t){e.exports=require("@material-ui/core/Switch")},function(e,t){e.exports=require("@material-ui/icons/AddBox")},function(e,t){e.exports=require("@material-ui/core/ListSubheader")},function(e,t){e.exports=require("@material-ui/core/ListItemIcon")},function(e,t){e.exports=require("@material-ui/core/Drawer")},function(e,t){e.exports=require("@material-ui/icons/Info")},function(e,t){e.exports=require("@material-ui/icons/RadioButtonUnchecked")},function(e,t){e.exports=require("@material-ui/core")},function(e,t){e.exports=require("@material-ui/core/colors")},function(e,t){e.exports=require("crypto")},function(e,t){e.exports=require("express-jwt")},function(e,t){e.exports=require("jsonwebtoken")},function(e,t,a){e.exports=a(77)},function(e,t){e.exports=require("@material-ui/core/Box")},function(e,t){e.exports=require("@material-ui/icons/Group")},function(e,t,a){"use strict";a.r(t);var r={env:"production",PORT:process.env.PORT||3e3,jwtSecret:process.env.JWT_SECRET||"Make person no tell me say i too lazy",mongoUri:process.env.MONGODB_URI||process.env.MONGO_HOST||"mongodb://"+(process.env.IP||"localhost")+":"+(process.env.MONGO_PORT||"27017")+"/mernclassroomv1"},n=a(48),o=a.n(n),l=a(16),i=a.n(l),s=a(42),c=a.n(s),u=a(49),m=a.n(u),d=a(50),p=a.n(d),g=a(51),h=a.n(g),E=a(52),f=a.n(E),y=a(0),b=a.n(y),x=a(53),v=a.n(x),w=a(54),j=a.n(w),S=a(1);const{signout:k}=a(40);function C(){return"undefined"!=typeof window&&(!!sessionStorage.getItem("jwt")&&JSON.parse(sessionStorage.getItem("jwt")))}function N(e){"undefined"!=typeof window&&sessionStorage.removeItem("jwt"),e(),k.then(e=>{document.cookie="t=; expires=Thu, 01 Jan 1970 00:00:00 UTC; path=/;"})}function T(){return(T=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var r in a)Object.prototype.hasOwnProperty.call(a,r)&&(e[r]=a[r])}return e}).apply(this,arguments)}var I=({component:e,...t})=>b.a.createElement(S.Route,T({},t,{render:t=>C()?b.a.createElement(e,t):b.a.createElement(S.Redirect,{to:{pathname:"/signin",state:{from:t.location}}})})),q=a(55),_=a.n(q),O=a(56),A=a.n(O),L=a(3),R=a.n(L),P=a(6),B=a.n(P),D=a(57),F=a.n(D),z=a(58),U=a.n(z),$=a(2),W=a.n($);const M=(e,t)=>e.location.pathname==t?{color:"#ff4081"}:{color:"#ffffff"},G=(e,t)=>e.location.pathname.includes(t)?{color:"#fffde7",backgroundColor:"#f57c00",marginRight:10}:{color:"#616161",backgroundColor:"#fffde7",border:"1px solid #f57c00",marginRight:10};var H=Object(S.withRouter)(({history:e})=>b.a.createElement(_.a,{style:{zIndex:"5000 !important"},position:"static",elevation:"10"},b.a.createElement(A.a,{style:{zIndex:"5000 !important"}},b.a.createElement(R.a,{variant:"h6",color:"inherit"},"CLASSROOM APP"),b.a.createElement(S.Link,{to:"/"},b.a.createElement(B.a,{"aria-label":"Home",style:M(e,"/")},b.a.createElement(F.a,null))),b.a.createElement(S.Link,{to:"/users"},b.a.createElement(W.a,{style:M(e,"/users")},"Users")),!C()&&b.a.createElement(b.a.Fragment,null,b.a.createElement(S.Link,{to:"/signup"},b.a.createElement(W.a,{style:M(e,"/signup")},"Sign Up")),b.a.createElement(S.Link,{to:"/signin"},b.a.createElement(W.a,{style:M(e,"/signin")},"Sign in"))),C()&&b.a.createElement("span",null,C().user.educator&&b.a.createElement(S.Link,{to:"/teach/courses"},b.a.createElement(W.a,{style:G(e,"/teach/")},b.a.createElement(U.a,null)," Teach")),b.a.createElement(S.Link,{to:"/user/"+C().user._id},b.a.createElement(W.a,{style:M(e,"/user/"+C().user._id)},"My Profile")),b.a.createElement(W.a,{color:"inherit",onClick:()=>{N(()=>e.push("/"))}},"Sign out"))))),J=a(4),V=a(8),Y=a.n(V),X=(a(75),a(23)),K=a.n(X),Q=a(25),Z=a.n(Q),ee=(a.p,a(13)),te=a.n(ee),ae=a(30),re=a.n(ae),ne=a(31),oe=a.n(ne),le=a(32),ie=a.n(le);Object(J.makeStyles)(e=>({form:{minWidth:500}}));const se=e=>{const[t,a]=Object(y.useState)({enrollmentId:"",error:"",redirect:!1});return t.redirect?b.a.createElement(S.Redirect,{to:"/learn/"+t.enrollmentId}):b.a.createElement(W.a,{variant:"contained",color:"secondary",onClick:()=>{const r=C();(async e=>{console.log(e);try{let t=await fetch("/api/enrollment/new/"+e.courseId,{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json",Authorization:"Bearer "+e.token}});return await t.json()}catch(e){console.log(e)}})({courseId:e.courseId,token:r.token}).then(e=>{e.error?a({...t,error:e.error}):a({...t,enrollmentId:e._id,redirect:!0})})}},"Enroll")};se.propTypes={courseId:te.a.string.isRequired};var ce=se;const ue=Object(J.makeStyles)(e=>({title:{padding:`${e.spacing(3)}px ${e.spacing(2.5)}px ${e.spacing(2)}px`,color:e.palette.openTitle},media:{minHeight:400},gridList:{width:"100%",minHeight:200,padding:"16px 0 0px"},tile:{textAlign:"center",border:"1px solid #cecece",backgroundColor:"#04040c"},image:{height:"100%"},tileBar:{backgroundColor:"rgba(0, 0, 0, 0.85)",textAlign:"left"},tileTitle:{fontSize:"1.1em",marginBottom:"5px",color:"#fffde7",display:"block"},action:{margin:"0 10px"}})),me=e=>{const t=ue();return b.a.createElement(re.a,{cellHeight:220,className:t.gridList,cols:2},e.courses.map((e,a)=>b.a.createElement(oe.a,{className:t.tile,key:a,style:{padding:0}},b.a.createElement(S.Link,{to:"/course/"+e._id},b.a.createElement("img",{className:t.image,src:"/api/courses/photo/"+e._id,alt:e.name})),b.a.createElement(ie.a,{className:t.tileBar,title:b.a.createElement(S.Link,{to:"/course/"+e._id,className:t.tileTitle},e.name),subtitle:b.a.createElement("span",null,e.category),actionIcon:b.a.createElement("div",{className:t.action},C()?b.a.createElement(ce,{courseId:e._id}):b.a.createElement(S.Link,{to:"/signin"},"Sign in to Enroll"))}))))};me.propTypes={courses:te.a.array.isRequired,common:te.a.func};var de=me;const pe=async(e,t)=>{try{let a=await fetch("/api/courses/"+e.courseId,{method:"GET",signal:t,headers:{Accept:"application/json","Content-Type":"application/json"}});return await a.json()}catch(e){console.log(e)}},ge=async(e,t)=>{try{let a=await fetch("/api/courses/"+e.courseId,{method:"PUT",headers:{Accept:"application/json",Authorization:"Bearer "+e.token},body:t});return await a.json()}catch(e){console.log(e)}};var he=a(41),Ee=a.n(he),fe=a(59),ye=a.n(fe);const be=Object(J.makeStyles)(e=>({title:{padding:`${e.spacing(3)}px ${e.spacing(2.5)}px ${e.spacing(2)}px`,color:e.palette.openTitle},media:{minHeight:400},container:{minWidth:"100%",paddingBottom:"14px"},gridList:{width:"100%",minHeight:100,padding:"12px 0 10px"},tile:{textAlign:"center"},image:{height:"100%"},tileBar:{backgroundColor:"rgba(0, 0, 0, 0.85)",textAlign:"left"},tileTitle:{fontSize:"1.1em",marginBottom:"5px",color:"#fffde7",display:"block"},action:{margin:"0 10px"},progress:{color:"#b4f8b4"}}));var xe=e=>{const t=be();return b.a.createElement("div",null,b.a.createElement(re.a,{cellHeight:120,cols:4,className:t.gridList},e.enrollments.map((e,a)=>b.a.createElement(oe.a,{key:a,className:t.tile},b.a.createElement(S.Link,{to:"/learn/"+e._id},b.a.createElement("img",{className:t.image,alt:e.course.name,src:"/api/courses/photo/"+e.course._id})),b.a.createElement(ie.a,{className:t.tileBar,title:b.a.createElement(S.Link,{className:t.tileTitle,to:"/learn/"+e._id},e.course.name),actionIcon:b.a.createElement("div",{className:t.action},e.completed?b.a.createElement(Ee.a,{color:"secondary"}):b.a.createElement(ye.a,{className:t.progress}))})))))};const ve=Object(J.makeStyles)(e=>({card:{width:"90%",margin:"auto",marginTop:20,marginBottom:e.spacing(2),padding:20,backgroundColor:"#ffffff"},extraTop:{marginTop:e.spacing(12)},title:{padding:`${e.spacing(3)}px ${e.spacing(2.5)}px ${e.spacing(2)}px`,color:e.palette.openTitle},media:{minHeight:400},gridList:{width:"100%",minHeight:200,padding:"16px 0 10px"},tile:{textAlign:"center"},image:{height:"100%"},tileBar:{backgroundColor:"rgba(0, 0, 0, 0.72)",textAlign:"left"},enrolledTitle:{color:"#efefef",marginBottom:5},action:{margin:"0 10px"},enrolledCard:{backgroundColor:"#616161"},divider:{marginBottom:16,backgroundColor:"rgb(157, 157, 157)"},noTitle:{color:"lightgrey",marginBottom:12,marginLeft:8}}));var we=()=>{const e=ve(),t=C(),[a,r]=Object(y.useState)([]),[n,o]=Object(y.useState)([]);return Object(y.useEffect)(()=>{const e=new AbortController,a=e.signal;return(async(e,t)=>{try{let a=await fetch("/api/enrollment/enrolled",{method:"GET",headers:{Accept:"application/json",Authorization:"Bearer "+e.token},signal:t});return await a.json()}catch(e){console.log(e)}})({token:t.token},a).then(e=>{e.error?console.log(e.error):o(e)}),function(){e.abort()}},[]),Object(y.useEffect)(()=>{const e=new AbortController;return(async e=>{try{return(await fetch("/api/courses/published",{method:"GET",headers:{Accept:"application/json","Content-Type":"application/json"},signal:e})).json()}catch(e){console.log(e)}})(e.signal).then(e=>{e.error?console.log(e.error):r(e)}),function(){e.abort()}},[]),b.a.createElement("div",{className:e.extraTop},t.user&&b.a.createElement(Y.a,{className:`${e.card} ${e.enrolledCard}`},b.a.createElement(R.a,{variant:"h6",component:"h2",className:e.enrolledTitle},"Courses you are enrolled in"),0!=n.length?b.a.createElement(xe,{enrollments:n}):b.a.createElement(R.a,{variant:"body1",className:e.noTitle},"No courses.")),b.a.createElement(Y.a,{className:e.card},b.a.createElement(R.a,{variant:"h5",component:"h2"},"Published Courses"),0!=a.length?b.a.createElement(de,{courses:a}):b.a.createElement(R.a,{variant:"body1",className:e.noTitle},"No New Courses")))},je=a(26),Se=a.n(je),ke=a(11),Ce=a.n(ke),Ne=a(9),Te=a.n(Ne),Ie=a(14),qe=a.n(Ie),_e=a(24),Oe=a.n(_e),Ae=a(10),Le=a.n(Ae),Re=a(15),Pe=a.n(Re),Be=a(60),De=a.n(Be),Fe=a(33),ze=a.n(Fe);const Ue=async(e,t)=>{try{let a=await fetch("/api/user/"+e.userId,{method:"GET",signal:t,headers:{Accept:"application/json","Content-Type":"application/json",Authorization:"Bearer "+e.token}});return await a.json()}catch(e){console.log(e)}},$e=Object(J.makeStyles)(e=>({root:e.mixins.gutters({padding:e.spacing(1),margin:e.spacing(5)}),title:{margin:`${e.spacing(4)}px 0 ${e.spacing(2)}px`,color:e.palette.openTitle}}));var We=e=>{const t=$e(),[a,r]=b.a.useState([]);return b.a.useEffect(()=>{const e=new AbortController;return(async e=>{try{let t=await fetch("/api/user",{method:"GET",signal:e});return await t.json()}catch(e){console.log(e)}})(e.signal).then(e=>{e&&e.error?console.log(e.error):r(e)}),function(){e.abort()}},[]),b.a.createElement(Se.a,{className:t.root,elevation:4},b.a.createElement(R.a,{variant:"h6",className:t.title},"All Users"),b.a.createElement(Ce.a,{dense:!0},a.map((e,t)=>b.a.createElement(S.Link,{to:"/user/"+e._id,key:t},b.a.createElement(Te.a,{button:!0},b.a.createElement(qe.a,null,b.a.createElement(Pe.a,null,b.a.createElement(ze.a,null))),b.a.createElement(Le.a,{primary:e.name}),b.a.createElement(Oe.a,null,b.a.createElement(B.a,null,b.a.createElement(De.a,null))))))))},Me=a(17),Ge=a.n(Me),He=a(5),Je=a.n(He),Ve=a(18),Ye=a.n(Ve),Xe=a(19),Ke=a.n(Xe),Qe=a(20),Ze=a.n(Qe),et=a(27),tt=a.n(et),at=a(21),rt=a.n(at),nt=a(34),ot=a.n(nt),lt=a(35),it=a.n(lt),st=a(36),ct=a.n(st);const ut=Object(J.makeStyles)(e=>({card:{maxWidth:600,margin:"auto",textAlign:"center",marginTop:e.spacing(5),paddingBottom:e.spacing(2)},error:{verticalAlign:"middle"},title:{marginTop:e.spacing(2),color:e.palette.openTitle},textField:{marginLeft:e.spacing(1),marginRight:e.spacing(1),width:300},submit:{margin:"auto",marginBottom:e.spacing(2)}}));var mt=()=>{const e=ut(),[t,a]=b.a.useState({name:"",password:"",email:""}),[r,n]=b.a.useState({open:!1,error:"",submit:!1}),[o,l]=b.a.useState(!0);b.a.useEffect(()=>{const e=i();n({...r,submit:!e})},[t]);const i=()=>["name","email","password"].every(e=>t[e].length>3),s=e=>r=>{a({...t,[e]:r.target.value})};return b.a.createElement(b.a.Fragment,null,b.a.createElement(Y.a,{className:e.card},b.a.createElement(K.a,null,b.a.createElement(R.a,{variant:"h6",className:e.title},"Sign Up"),b.a.createElement(Je.a,{id:"name",label:"Name",margin:"normal",className:e.textField,value:t.name,onChange:s("name")}),b.a.createElement("br",null),b.a.createElement(Je.a,{id:"email",type:"email",label:"Email",className:e.textField,value:t.email,onChange:s("email"),margin:"normal"}),b.a.createElement("br",null),b.a.createElement(Je.a,{id:"password",type:o?"text":"password",InputProps:{endAdornment:b.a.createElement(ct.a,{position:"end"},b.a.createElement(B.a,{onClick:()=>{l(!o)}},o?b.a.createElement(ot.a,null):b.a.createElement(it.a,null)))},label:"Password",className:e.textField,value:t.password,margin:"normal",onChange:s("password")}),b.a.createElement("br",null)," ",r.error&&b.a.createElement(R.a,{component:"p",color:"error"},r.error)),b.a.createElement(Ge.a,null,b.a.createElement(W.a,{color:"primary",disabled:r.submit,className:e.submit,variant:"contained",onClick:()=>{n({...r,error:""}),(async e=>{try{let t=await fetch("/api/user",{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify(e)});return await t.json()}catch(e){console.log(e)}})(t).then(e=>{e.error?-1!==e.error.indexOf("email already exists")?n({...r,error:"Email Already Exist"}):n({...r,error:e.error}):n({...r,open:!0})})}},"Submit"))),b.a.createElement(Ye.a,{open:r.open,disableBackdropClick:!0},b.a.createElement(rt.a,null,"New Title"),b.a.createElement(Ze.a,null,b.a.createElement(tt.a,null,"New Account successfully created")),b.a.createElement(Ke.a,null,b.a.createElement(S.Link,{to:"/signin"},b.a.createElement(W.a,{color:"primary",variant:"contained",autoFocus:"autoFocus"},"Sign In")))))},dt=a(40);const pt=Object(J.makeStyles)(e=>({card:{maxWidth:600,margin:"auto",textAlign:"center",marginTop:e.spacing(5),paddingBottom:e.spacing(2)},error:{verticalAlign:"middle"},title:{marginTop:e.spacing(2),color:e.palette.openTitle},textField:{marginLeft:e.spacing(1),marginRight:e.spacing(1),width:300},submit:{margin:"auto",marginBottom:e.spacing(2)}}));var gt=e=>{const t=pt(),[a,r]=b.a.useState({email:"",password:""}),[n,o]=b.a.useState({error:"",submit:!0,redirectToReferrer:!1});b.a.useEffect(()=>{const e=l();o({...n,submit:!e})},[a]);const l=()=>["email","password"].every(e=>a[e].length>3),i=e=>t=>{r({...a,[e]:t.target.value})},{redirectToReferrer:s}=n;if(s){const{from:t}=e.location.state||{from:{pathname:"/"}};return b.a.createElement(S.Redirect,{to:t})}return b.a.createElement(Y.a,{className:t.card},b.a.createElement(K.a,null,b.a.createElement(R.a,{variant:"h6",className:t.title},"Sign In"),b.a.createElement(Je.a,{id:"email",type:"email",label:"Email",className:t.textField,value:a.email,onChange:i("email"),margin:"normal"}),b.a.createElement("br",null),b.a.createElement(Je.a,{id:"password",type:"password",label:"Password",className:t.textField,value:a.password,onChange:i("password"),margin:"normal"}),b.a.createElement("br",null)," ",n.error&&b.a.createElement(R.a,{component:"p",color:"error"},n.error)),b.a.createElement(Ge.a,null,b.a.createElement(W.a,{disabled:n.submit,color:"primary",variant:"contained",onClick:()=>{Object(dt.signin)(a).then(e=>{if(e.error)return o({...n,error:e.error});var t,a;e.token&&(t=e,a=()=>{o({...n,error:"",redirectToReferrer:!0})},"undefined"!=typeof window&&sessionStorage.setItem("jwt",JSON.stringify(t)),a())})},className:t.submit},"Submit")))},ht=a(37),Et=a.n(ht),ft=a(12),yt=a.n(ft),bt=a(28),xt=a.n(bt);const vt=e=>{const[t,a]=b.a.useState(!1),[r,n]=b.a.useState(!1),o=()=>{a(!t)};return r?b.a.createElement(S.Redirect,{to:"/"}):b.a.createElement("span",null,b.a.createElement(B.a,{"aria-label":"Delete",onClick:o,color:"secondary"},b.a.createElement(xt.a,null)),b.a.createElement(Ye.a,{open:t,onClose:o},b.a.createElement(rt.a,null,"Delete Account"),b.a.createElement(Ze.a,null,b.a.createElement(tt.a,null,"Confirm to delete your account.")),b.a.createElement(Ke.a,null,b.a.createElement(W.a,{onClick:o,color:"primary"},"Cancel"),b.a.createElement(W.a,{onClick:()=>{const t=C();(async(e,t)=>{try{let a=await fetch("/api/user/"+e.userId,{method:"DELETE",headers:{Accept:"application/json","Content-Type":"application/json",Authorization:"Bearer "+t.t}});return await a.json()}catch(e){console.log(e)}})({userId:e.userId},{token:t.token}).then(e=>{e&&e.error?console.log(e.error):(N(()=>console.log("deleted")),n(!0))})},color:"secondary",autoFocus:"autoFocus"},"Confirm"))))};vt.propTypes={userId:te.a.string.isRequired};var wt=vt,jt=a(38),St=a.n(jt),kt=a(29),Ct=a.n(kt);const Nt=Object(J.makeStyles)(e=>({card:{maxWidth:600,margin:"auto",textAlign:"center",marginTop:e.spacing(12),paddingBottom:e.spacing(2)},error:{verticalAlign:"middle"},title:{marginTop:e.spacing(2),color:e.palette.openTitle},textField:{marginLeft:e.spacing(1),marginRight:e.spacing(1),width:300},submit:{margin:"auto",marginBottom:e.spacing(2)},input:{display:"none"},filename:{marginLeft:"10px"}}));var Tt=()=>{const e=Nt(),[t,a]=Object(y.useState)({name:"",description:"",image:null,category:""}),[r,n]=Object(y.useState)({redirect:!1,error:""}),o=C(),l=e=>r=>{const n="image"===e?r.target.files[0]:r.target.value;a({...t,[e]:n})};return r.redirect?b.a.createElement(S.Redirect,{to:"/teach/courses"}):b.a.createElement("div",null,b.a.createElement(Y.a,{className:e.card},b.a.createElement(K.a,null,b.a.createElement(R.a,{variant:"h6",className:e.title},"New Course"),b.a.createElement("br",null),b.a.createElement("input",{accept:"image/*",onChange:l("image"),className:e.input,id:"icon-button-file",type:"file"}),b.a.createElement("label",{htmlFor:"icon-button-file"},b.a.createElement(W.a,{variant:"contained",color:"secondary",component:"span"},"Upload Photo",b.a.createElement(St.a,null)))," ",b.a.createElement("span",{className:e.filename},t.image?t.image.name:""),b.a.createElement("br",null),b.a.createElement(Je.a,{id:"name",label:"Name",className:e.textField,value:t.name,onChange:l("name"),margin:"normal"}),b.a.createElement("br",null),b.a.createElement(Je.a,{id:"multiline-flexible",label:"Description",multiline:!0,rows:"2",value:t.description,onChange:l("description"),className:e.textField,margin:"normal"}),b.a.createElement("br",null),b.a.createElement(Je.a,{id:"category",label:"Category",className:e.textField,value:t.category,onChange:l("category"),margin:"normal"}),b.a.createElement("br",null),t.error&&b.a.createElement(R.a,{component:"p",color:"error"},b.a.createElement(Ct.a,{color:"error",className:e.error},"error"),t.error)),b.a.createElement(Ge.a,null,b.a.createElement(W.a,{color:"primary",variant:"contained",onClick:()=>{let e=new FormData;t.name&&e.append("name",t.name),t.description&&e.append("description",t.description),t.image&&e.append("image",t.image),t.category&&e.append("category",t.category),(async(e,t)=>{try{return(await fetch("/api/courses/by/"+e.userId,{method:"POST",headers:{Accept:"application/json",Authorization:"Bearer "+e.token},body:t})).json()}catch(e){console.log(e)}})({userId:o.user._id,token:o.token},e).then(e=>{e.error?n({...r,error:e.error}):n({...r,error:"",redirect:!0})})},className:e.submit},"Submit"),b.a.createElement(S.Link,{to:"/teach/courses",className:e.submit},b.a.createElement(W.a,{variant:"contained"},"Cancel")))))};const It=Object(J.makeStyles)(e=>({root:e.mixins.gutters({maxWidth:600,margin:"auto",padding:e.spacing(3),marginTop:e.spacing(5)}),title:{marginTop:e.spacing(3),color:e.palette.protectedTitle}}));var qt=({match:e})=>{const t=It(),[a,r]=b.a.useState({}),[n,o]=b.a.useState(!1),l=C();return b.a.useEffect(()=>{const t=new AbortController,a=t.signal;return Ue({userId:e.params.userId,token:l.token},a).then(e=>{e&&e.error?o(!0):r(e)}),function(){t.abort()}},[e.params.userId]),n?b.a.createElement(S.Redirect,{to:"/signin"}):b.a.createElement(b.a.Fragment,null,b.a.createElement(Se.a,{className:t.root,elevation:4},b.a.createElement(R.a,{variant:"h6",className:t.title},"Profile"),b.a.createElement(Ce.a,{dense:!0},b.a.createElement(Te.a,null,b.a.createElement(qe.a,null,b.a.createElement(Pe.a,null,b.a.createElement(ze.a,null))),b.a.createElement(Le.a,{primary:a.name,secondary:a.email}),l.user&&l.user._id==a._id&&b.a.createElement(Oe.a,null,b.a.createElement(S.Link,{to:"/user/edit/"+a._id},b.a.createElement(B.a,{"aria-label":"Edit",color:"primary"},b.a.createElement(Et.a,null))),b.a.createElement(wt,{userId:l.user._id}))),b.a.createElement(yt.a,null),b.a.createElement(Te.a,null,b.a.createElement(Le.a,{primary:"Joined: "+new Date(a.created).toDateString()})))),b.a.createElement(Tt,null))},_t=a(61),Ot=a.n(_t),At=a(62),Lt=a.n(At);const Rt=Object(J.makeStyles)(e=>({card:{maxWidth:600,margin:"auto",textAlign:"center",marginTop:e.spacing(5),paddingBottom:e.spacing(2)},title:{margin:e.spacing(2),color:e.palette.protectedTitle},error:{verticalAlign:"middle"},textField:{marginLeft:e.spacing(1),marginRight:e.spacing(1),width:300},submit:{margin:"auto",marginBottom:e.spacing(2)}}));var Pt=({match:e})=>{const t=Rt(),[a,r]=Object(y.useState)({name:"",password:"",email:"",educator:!1}),[n,o]=Object(y.useState)({open:!1,error:"",userId:"",redirectToProfile:!1}),[l,i]=Object(y.useState)(!1),s=C();Object(y.useEffect)(()=>{const t=new AbortController,l=t.signal;return Ue({userId:e.params.userId,token:s.token},l).then(e=>{e&&e.error?o({...n,error:e.error}):r({...a,name:e.name,email:e.email,educator:e.educator})}),function(){t.abort()}},[e.params.userId]);const c=e=>t=>{r({...a,[e]:t.target.value})};return n.redirectToProfile?b.a.createElement(S.Redirect,{to:"/user/"+n.userId}):b.a.createElement(Y.a,{className:t.card},b.a.createElement(K.a,null,b.a.createElement(R.a,{variant:"h6",className:t.title},"Edit Profile"),b.a.createElement(Je.a,{id:"name",label:"Name",className:t.textField,value:a.name,onChange:c("name"),margin:"normal"}),b.a.createElement("br",null),b.a.createElement(Je.a,{id:"email",type:"email",label:"Email",className:t.textField,value:a.email,onChange:c("email"),margin:"normal"}),b.a.createElement("br",null),b.a.createElement(Je.a,{id:"password",type:l?"text":"password",label:"Password",autoFocus:!1,className:t.textField,value:a.password,onChange:c("password"),margin:"normal",InputProps:{endAdornment:b.a.createElement(ct.a,{position:"end"},b.a.createElement(B.a,{onClick:()=>{i(!l)}},l?b.a.createElement(ot.a,null):b.a.createElement(it.a,null)))}}),b.a.createElement(R.a,{variant:"subtitle1",className:t.subheading},"I am an Educator"),b.a.createElement(Ot.a,{control:b.a.createElement(Lt.a,{classes:{checked:t.checked,bar:t.bar},checked:a.educator,onChange:(e,t)=>{r({...a,educator:t})}}),label:a.educator?"Yes":"No"}),b.a.createElement("br",null)," ",n.error&&b.a.createElement(R.a,{component:"p",color:"error"},n.error)),b.a.createElement(Ge.a,null,b.a.createElement(W.a,{color:"primary",variant:"contained",className:t.submit,onClick:()=>{(async(e,t)=>{try{let a=await fetch("/api/user/"+e.userId,{method:"PUT",headers:{Accept:"application/json","Content-Type":"application/json",Authorization:"Bearer "+e.token},body:JSON.stringify(t)});return await a.json()}catch(e){console.log(e)}})({userId:e.params.userId,token:s.token},a).then(e=>{console.log(e),e&&e.error?o({...n,error:e.error}):function(e,t){if("undefined"!=typeof window&&sessionStorage.getItem("jwt")){let a=JSON.parse(sessionStorage.getItem("jwt"));a.user=e,sessionStorage.setItem("jwt",JSON.stringify(a)),t()}}(e,()=>{o({...n,userId:e._id,redirectToProfile:!0})})})}},"Submit")))};const Bt=Object(J.makeStyles)(e=>({root:e.mixins.gutters({maxWidth:600,margin:"auto",padding:e.spacing(3),marginTop:e.spacing(12)}),title:{margin:`${e.spacing(3)}px 0 ${e.spacing(3)}px ${e.spacing(1)}px`,color:e.palette.protectedTitle,fontSize:"1.2em"},addButton:{float:"right"},leftIcon:{marginRight:"8px"},avatar:{borderRadius:0,width:65,height:40},listText:{marginLeft:16}}));var Dt=()=>{const e=Bt(),[t,a]=Object(y.useState)([]),[r,n]=Object(y.useState)(!1),o=C();return Object(y.useEffect)(()=>{const e=new AbortController,t=e.signal;return(async(e,t)=>{try{return(await fetch("/api/courses/by/"+e.userId,{method:"GET",signal:t,headers:{Accept:"application/json",Authorization:"Bearer "+e.token}})).json()}catch(e){console.log(e)}})({userId:o.user._id,token:o.token},t).then(e=>{e.error?n(!0):a(e)}),function(){e.abort()}},[]),r?b.a.createElement(S.Redirect,{to:"/signin"}):b.a.createElement("div",null,b.a.createElement(Se.a,{className:e.root,elevation:4},b.a.createElement(R.a,{type:"title",className:e.title},"My Courses",b.a.createElement("span",{className:e.addButton},b.a.createElement(S.Link,{to:"/teach/course/new"},b.a.createElement(W.a,{color:"primary",variant:"contained"},b.a.createElement(Ct.a,{className:e.leftIcon},"add_box"),"  New Course")))),b.a.createElement(Ce.a,{dense:!0},t.map((t,a)=>b.a.createElement(S.Link,{to:"/course/"+t._id,key:a},b.a.createElement(Te.a,{button:!0},b.a.createElement(qe.a,null,b.a.createElement(Pe.a,{src:"/api/courses/photo/"+t._id+"?"+(new Date).getTime(),className:e.avatar})),b.a.createElement(Le.a,{primary:t.name,secondary:t.description,className:e.listText})),b.a.createElement(yt.a,null))))))},Ft=a(22),zt=a.n(Ft),Ut=(a(76),a(63)),$t=a.n(Ut);const Wt=Object(J.makeStyles)(e=>({form:{minWidth:500}})),Mt=e=>{const t=Wt(),[a,r]=Object(y.useState)(!1),[n,o]=Object(y.useState)({title:"",content:"",resource_url:""}),[l,i]=Object(y.useState)({error:"",submit:!0}),s=()=>{r(!a)},c=e=>t=>{o({...n,[e]:t.target.value})},u=C();b.a.useEffect(()=>{const e=m();i({...l,submit:!e})},[n]);const m=()=>["title","content","resource_url"].every(e=>n[e].length>3);return b.a.createElement(b.a.Fragment,null,b.a.createElement(W.a,{"aria-label":"Add Lesson",color:"primary",variant:"contained",onClick:s},b.a.createElement($t.a,null),"   New Lesson"),b.a.createElement(Ye.a,{open:a,onClose:s,"aria-labelledby":"form-dialog-title"},b.a.createElement("div",{className:t.form},b.a.createElement(rt.a,{id:"form-dialog-title"},"New Lesson for  ",b.a.createElement("em",null,e.title)),b.a.createElement(Ze.a,null,b.a.createElement(Je.a,{margin:"dense",fullWidth:!0,label:"Title",type:"text",value:n.title,onChange:c("title")}),b.a.createElement("br",null),b.a.createElement(Je.a,{margin:"dense",label:"Content",type:"text",multiline:!0,rows:"5",fullWidth:!0,value:n.content,onChange:c("content")}),b.a.createElement("br",null),b.a.createElement(Je.a,{margin:"dense",label:"Resource link",type:"text",fullWidth:!0,value:n.resource_url,onChange:c("resource_url")}),b.a.createElement("br",null)),b.a.createElement(Ke.a,null,b.a.createElement(W.a,{onClick:s,color:"primary",variant:"contained"},"Cancel"),b.a.createElement(W.a,{onClick:()=>{const t={title:n.title||void 0,content:n.content||void 0,resource_url:n.resource_url||void 0};(async(e,t)=>{try{return(await fetch("/api/courses/"+e.courseId+"/lesson/new",{method:"PUT",headers:{Accept:"application/json","Content-Type":"application/json",Authorization:"Bearer "+e.token},body:JSON.stringify({lesson:t})})).json()}catch(e){console.log(e)}})({courseId:e.courseId,token:u.token},t).then(t=>{t&&t.error?o({...n,error:t.error}):(e.addLesson(t),o({...n,title:"",content:"",resource_url:""}),r(!1))})},disabled:l.submit,color:"secondary",variant:"contained"},"Add")))))};Mt.propTypes={courseId:te.a.string.isRequired,addLesson:te.a.func.isRequired,title:te.a.string.isRequired};var Gt=Mt;const Ht=e=>{const[t,a]=Object(y.useState)(!1),r=C(),n=()=>{a(!t)};return b.a.createElement("span",null,b.a.createElement(B.a,{"aria-label":"Delete",onClick:n,color:"secondary"},b.a.createElement(xt.a,null)),b.a.createElement(Ye.a,{open:t,onClose:n},b.a.createElement(rt.a,null,"Delete "+e.course.name),b.a.createElement(Ze.a,null,b.a.createElement(tt.a,null,"Confirm to delete your course ",e.course.name,".")),b.a.createElement(Ke.a,null,b.a.createElement(W.a,{onClick:n,color:"primary"},"Cancel"),b.a.createElement(W.a,{onClick:()=>{(async e=>{try{let t=await fetch("/api/courses/"+e.courseId,{method:"DELETE",headers:{Accept:"application/json","Content-Type":"application/json",Authorization:"Bearer "+e.token}});return await t.json()}catch(e){console.log(e)}})({courseId:e.course._id,token:r.token}).then(t=>{t.error?console.log(t.error):(a(!1),e.onRemove(e.course))})},color:"secondary",autoFocus:"autoFocus"},"Confirm"))))};Ht.propTypes={course:te.a.object.isRequired,onRemove:te.a.func.isRequired};var Jt=Ht;const Vt=Object(J.makeStyles)(e=>({root:e.mixins.gutters({maxWidth:800,margin:"auto",padding:e.spacing(3),marginTop:e.spacing(12)}),flex:{display:"flex",marginBottom:20,flexDirection:"column"},card:{padding:"24px 40px 40px"},subheading:{margin:"10px",color:e.palette.openTitle,fontSize:"1.2em"},details:{margin:"16px"},sub:{display:"block",margin:"3px 0px 5px 0px",fontSize:"0.9em"},media:{height:190,display:"inline-block",width:"100%",marginLeft:"16px"},icon:{verticalAlign:"sub"},category:{color:"#5c5c5c",fontSize:"0.9em",padding:"3px 5px",backgroundColor:"#dbdbdb",borderRadius:"0.2em",marginTop:5},action:{margin:"10px 0px",display:"flex",justifyContent:"flex-end"},statSpan:{margin:"7px 10px 0 10px",alignItems:"center",color:"#616161",display:"inline-flex","& svg":{marginRight:10,color:"#b6ab9a"}},enroll:{float:"right"}}));var Yt=({match:e})=>{var t,a;const r=Vt(),[n,o]=Object(y.useState)({instructor:{}}),[l,i]=Object(y.useState)({redirect:!1,error:""}),[s,c]=Object(y.useState)(!1),u=C();Object(y.useEffect)(()=>{const t=new AbortController,a=t.signal;return pe({courseId:e.params.courseId},a).then(e=>{e.error?i({...l,error:e.error}):(console.log(e),o(e))}),function(){t.abort()}},[e.params.courseId]);const m=()=>{c(!s)},d=n._id?`/api/courses/photo/${n._id}?${(new Date).getTime()}`:"/api/courses/defaultphoto";return l.redirect?b.a.createElement(S.Redirect,{to:"/teach/courses"}):b.a.createElement("div",{className:r.root},b.a.createElement(Y.a,{className:r.card},b.a.createElement(zt.a,{title:n.name,subheader:b.a.createElement("div",null,b.a.createElement(S.Link,{to:"/user/"+n.instructor._id,className:r.sub},"By ",n.instructor.name),b.a.createElement("span",{className:r.category},n.category)),action:b.a.createElement(b.a.Fragment,null,u.user&&u.user._id==n.instructor._id&&b.a.createElement("span",{className:r.action},n.published?b.a.createElement(W.a,{color:"secondary",disabled:!0,variant:"outlined"},"Published"):b.a.createElement(b.a.Fragment,null,b.a.createElement(W.a,{color:"secondary",variant:"outlined",onClick:()=>{n.lessons.length>0&&c(!0)}},0==n.lessons.length?"Add at least 1 lesson to publish":"Publish"),b.a.createElement(Jt,{course:n,onRemove:e=>{i({...l,redirect:!0})}}),b.a.createElement(S.Link,{to:"/teach/course/edit/"+n._id},b.a.createElement(B.a,{"aria-label":"Edit",color:"secondary"},b.a.createElement(Et.a,null))))))}),b.a.createElement("div",{className:r.flex},b.a.createElement(Z.a,{className:r.media,image:d,title:n.name}),b.a.createElement("div",{className:r.details},b.a.createElement(R.a,{variant:"body1",className:r.subheading},n.description))),b.a.createElement(yt.a,null),b.a.createElement("div",null,b.a.createElement(zt.a,{title:b.a.createElement(R.a,{variant:"h6",className:r.subheading},"Lessons"),subheader:b.a.createElement(R.a,{className:r.subheading,variant:"body1"},n.lessons&&n.lessons.length," Lessons"),action:(null===(t=u.user)||void 0===t?void 0:t._id)==n.instructor._id&&!n.published&&b.a.createElement("span",{className:r.action},b.a.createElement(Gt,{courseId:n._id,title:n.name,addLesson:e=>{o(e)}}))}),b.a.createElement(Ce.a,null,null===(a=n.lessons)||void 0===a?void 0:a.map((e,t)=>b.a.createElement("span",{key:t},b.a.createElement(Te.a,null,b.a.createElement(qe.a,null,b.a.createElement(Pe.a,null,t+1)),b.a.createElement(Le.a,{primary:e.title})),b.a.createElement(yt.a,{variant:"inset",component:"li"})))))),b.a.createElement(Ye.a,{open:s,onClose:m,"aria-labelledby":"form-dialog-title"},b.a.createElement(rt.a,{id:"form-dialog-title"},"Publish Course"),b.a.createElement(Ze.a,null,b.a.createElement(R.a,{variant:"body1"},"Publishing your course will make it live to students for enrollment. "),b.a.createElement(R.a,{variant:"body1"},"Make sure all lessons are added and ready for publishing.")),b.a.createElement(Ke.a,null,b.a.createElement(W.a,{onClick:m,color:"primary",variant:"contained"},"Cancel"),b.a.createElement(W.a,{onClick:()=>{let t=new FormData;t.append("published",!0),ge({courseId:e.params.courseId,token:u.token},t).then(e=>{e&&e.error?i({...l,error:e.error}):(o({...n,published:!0}),c(!1))})},color:"secondary",variant:"contained"},"Publish"))))},Xt=a(43),Kt=a.n(Xt);const Qt=Object(J.makeStyles)(e=>({root:e.mixins.gutters({maxWidth:800,margin:"auto",padding:e.spacing(3),marginTop:e.spacing(12)}),flex:{display:"flex",marginBottom:20},card:{padding:"24px 40px 40px"},subheading:{margin:"10px",color:e.palette.openTitle},details:{margin:"16px"},upArrow:{border:"2px solid #f57c00",marginLeft:3,marginTop:10,padding:4},sub:{display:"block",margin:"3px 0px 5px 0px",fontSize:"0.9em"},media:{height:250,display:"inline-block",width:"50%",marginLeft:"16px"},icon:{verticalAlign:"sub"},textfield:{width:350},action:{margin:"8px 24px",display:"inline-block"},input:{display:"none"},filename:{marginLeft:"10px"},list:{backgroundColor:"#f3f3f3"}}));var Zt=({match:e})=>{var t;const a=Qt(),r=C(),[n,o]=Object(y.useState)({name:"",description:"",image:"",category:"",instructor:{},lessons:[]}),[l,i]=Object(y.useState)({redirect:!1,error:""});Object(y.useEffect)(()=>{const t=new AbortController,a=t.signal;return pe({courseId:e.params.courseId},a).then(e=>{e.error?setValues({...values,error:e.error}):(e.image="",o(e))}),function(){t.abort()}},[e.params.courseId]);const s=e=>t=>{const a="image"===e?t.target.files[0]:t.target.value;o({...n,[e]:a})},c=e=>t=>{const{lessons:a}=n,r=a[e];a[e]=a[e+1],a[e+1]=r,o({...n,lessons:a})},u=(e,t)=>a=>{const r=n.lessons;r[t][e]=a.target.value,o({...n,lessons:r})},m=e=>t=>{const a=n.lessons;a.splice(e,1),o({...n,lessons:a})};if(l.redirect)return b.a.createElement(S.Redirect,{to:"/teach/course/"+n._id});const d=n._id?`/api/courses/photo/${n._id}?${(new Date).getTime()}`:"/api/courses/defaultphoto";return b.a.createElement("div",{className:a.root},b.a.createElement(Y.a,null,b.a.createElement(zt.a,{title:b.a.createElement(Je.a,{margin:"dense",label:"Title",type:"text",fullWidth:!0,value:n.name,onChange:s("name")}),subheader:b.a.createElement("div",null,b.a.createElement(S.Link,{to:"/user/"+n.instructor._id,className:a.sub},"By ",n.instructor.name),b.a.createElement(Je.a,{margin:"dense",label:"Category",type:"text",fullWidth:!0,value:n.category,onChange:s("category")})),action:(null===(t=r.user)||void 0===t?void 0:t._id)==n.instructor._id&&b.a.createElement("span",{className:a.action},b.a.createElement(W.a,{variant:"contained",color:"secondary",onClick:()=>{let t=new FormData;n.name&&t.append("name",n.name),n.description&&t.append("description",n.description),n.image&&t.append("image",n.image),n.category&&t.append("category",n.category),t.append("lessons",JSON.stringify(n.lessons)),ge({courseId:e.params.courseId,token:r.token},t).then(e=>{e&&e.error?(console.log(e.error),i({...l,error:e.error})):i({...l,redirect:!0})})}},"Save"))}),b.a.createElement("div",{className:a.flex},b.a.createElement(Z.a,{className:a.media,image:d,title:n.name}),b.a.createElement("div",{className:a.details},b.a.createElement(Je.a,{margin:"dense",multiline:!0,rows:"5",label:"Description",type:"text",className:a.textfield,value:n.description,onChange:s("description")}),b.a.createElement("br",null),b.a.createElement("br",null),b.a.createElement("input",{accept:"image/*",onChange:s("image"),className:a.input,id:"icon-button-file",type:"file"}),b.a.createElement("label",{htmlFor:"icon-button-file"},b.a.createElement(W.a,{variant:"outlined",color:"secondary",component:"span"},"Change Photo",b.a.createElement(St.a,null)))," ",b.a.createElement("span",{className:a.filename},n.image?n.image.name:""),b.a.createElement("br",null))),b.a.createElement(yt.a,null),b.a.createElement("div",null,b.a.createElement(zt.a,{title:b.a.createElement(R.a,{variant:"h6",className:a.subheading},"Lessons - Edit and Rearrange"),subheader:b.a.createElement(R.a,{variant:"body1",className:a.subheading},n.lessons&&n.lessons.length," lessons")}),b.a.createElement(Ce.a,null,n.lessons&&n.lessons.map((e,t)=>{return b.a.createElement("span",{key:t},b.a.createElement(Te.a,{className:a.list},b.a.createElement(qe.a,null,b.a.createElement(b.a.Fragment,null,b.a.createElement(Pe.a,null,t+1),0!=t&&b.a.createElement(B.a,{"aria-label":"up",color:"primary",onClick:(r=t,e=>{const{lessons:t}=n,a=t[r];t[r]=t[r-1],t[r-1]=a,o({...n,lessons:t})}),className:a.upArrow},b.a.createElement(Kt.a,null)),t<n.lessons.length-1&&b.a.createElement(B.a,{"aria-label":"down",color:"primary",onClick:c(t),className:a.upArrow},b.a.createElement(Kt.a,{style:{transform:"rotate(180deg)"}})))),b.a.createElement(Le.a,{primary:b.a.createElement(b.a.Fragment,null,b.a.createElement(Je.a,{margin:"dense",label:"Title",type:"text",fullWidth:!0,value:e.title,onChange:u("title",t)}),b.a.createElement("br",null),b.a.createElement(Je.a,{margin:"dense",multiline:!0,rows:"5",label:"Content",type:"text",fullWidth:!0,value:e.content,onChange:u("content",t)}),b.a.createElement("br",null),b.a.createElement(Je.a,{margin:"dense",label:"Resource link",type:"text",fullWidth:!0,value:e.resource_url,onChange:u("resource_url",t)}),b.a.createElement("br",null))}),!n.published&&b.a.createElement(Oe.a,null,b.a.createElement(B.a,{edge:"end","aria-label":"up",color:"primary",onClick:m(t)},b.a.createElement(xt.a,null)))),b.a.createElement(yt.a,{style:{backgroundColor:"rgb(106, 106, 106)"},component:"li"}));var r})))))},ea=a(64),ta=a.n(ea),aa=a(65),ra=a.n(aa),na=a(66),oa=a.n(na),la=a(67),ia=a.n(la),sa=a(44),ca=a.n(sa),ua=a(68),ma=a.n(ua),da=a(69);const pa=Object(J.makeStyles)(e=>({root:e.mixins.gutters({maxWidth:800,margin:"auto",marginTop:e.spacing(12),marginLeft:250}),heading:{marginBottom:e.spacing(3),fontWeight:200},flex:{display:"flex",marginBottom:20},card:{padding:"24px 40px 20px"},subheading:{margin:"10px",color:e.palette.openTitle},details:{margin:"16px"},sub:{display:"block",margin:"3px 0px 5px 0px",fontSize:"0.9em"},avatar:{color:"#9b9b9b",border:"1px solid #bdbdbd",background:"none"},media:{height:180,display:"inline-block",width:"100%",marginLeft:"16px"},icon:{verticalAlign:"sub"},category:{color:"#5c5c5c",fontSize:"0.9em",padding:"3px 5px",backgroundColor:"#dbdbdb",borderRadius:"0.2em",marginTop:5},action:{margin:"8px 24px",display:"inline-block"},drawer:{width:240,flexShrink:0,zIndex:"-1"},drawerPaper:{width:240,backgroundColor:"#616161"},content:{flexGrow:1,padding:e.spacing(3)},toolbar:e.mixins.toolbar,selectedDrawer:{backgroundColor:"#e9e3df"},unselected:{backgroundColor:"#ffffff"},check:{color:"#38cc38"},subhead:{fontSize:"1.2em"},progress:{textAlign:"center",color:"#dfdfdf","& span":{color:"#fffde7",fontSize:"1.15em"}},para:{whiteSpace:"pre-wrap"}}));var ga=({match:e})=>{var t;const a=pa(),r=C(),[n,o]=Object(y.useState)({course:{instructor:[]},lessonStatus:[]}),[l,i]=Object(y.useState)(0),[s,c]=Object(y.useState)({redirect:!1,error:"",drawer:-1});Object(y.useEffect)(()=>{const t=new AbortController,a=t.signal;return(async(e,t)=>{try{return(await fetch("/api/enrollment/"+e.enrollmentId,{method:"GET",headers:{Authorization:"Bearer "+e.token,"Content-Type":"application/json",Accept:"application/json"},signal:t})).json()}catch(e){console.log(e)}})({enrollmentId:e.params.enrollmentId,token:r.token},a).then(e=>{e.error?c({...s,error:e.error}):(m(e.lessonStatus),o(e))}),function(){t.abort()}},[e.params.enrollmentId]);const u=e=>t=>{c({...s,drawer:e})},m=e=>{let t=e.reduce((e,t)=>e+(t.complete?1:0),0);return i(t),t};console.log(l);const d=n.course._id?`/api/courses/photo/${n.course._id}?${(new Date).getTime()}`:"/api/courses/defaultphoto";return b.a.createElement("div",{className:a.root},b.a.createElement(oa.a,{className:a.drawer,variant:"permanent",classes:{paper:a.drawerPaper}},b.a.createElement("div",{className:a.toolbar}),b.a.createElement(Ce.a,null,b.a.createElement(Te.a,{button:!0,onClick:u(-1),className:-1==s.drawer?a.selectedDrawer:a.unselected},b.a.createElement(ra.a,null,b.a.createElement(ia.a,null)),b.a.createElement(Le.a,{primary:"Course Overview"}))),b.a.createElement(yt.a,null),b.a.createElement(Ce.a,{className:a.unselected},b.a.createElement(ta.a,{component:"div",className:a.subhead},"Lessons"),n.lessonStatus.map((e,t)=>b.a.createElement(Te.a,{button:!0,key:t,onClick:u(t),className:s.drawer==t?a.selectedDrawer:a.unselected},b.a.createElement(qe.a,null,b.a.createElement(Pe.a,{className:a.avatar},t+1)),b.a.createElement(Le.a,{primary:n.course.lessons[t].title}),b.a.createElement(Oe.a,null,e.complete?b.a.createElement(ca.a,{className:a.check}):b.a.createElement(ma.a,null))))),b.a.createElement(yt.a,null),b.a.createElement(Ce.a,null,b.a.createElement(Te.a,null,b.a.createElement(Le.a,{primary:b.a.createElement("div",{className:a.progress},b.a.createElement("span",null,l)," out of",b.a.createElement("span",null," "+n.lessonStatus.length)," completed")})))),-1==s.drawer&&b.a.createElement(Y.a,{className:a.card},b.a.createElement(zt.a,{title:n.course.name,subheader:b.a.createElement("div",null,b.a.createElement(S.Link,{to:"/user/"+n.course.instructor._id,className:a.sub},"By ",n.course.instructor.name),b.a.createElement("span",{className:a.category},n.course.category)),action:l==n.lessonStatus.length&&b.a.createElement("span",{className:a.action},b.a.createElement(W.a,{variant:"contained",color:"secondary"},b.a.createElement(ca.a,null),"   Completed"))}),b.a.createElement("div",{className:a.flex},b.a.createElement(Z.a,{className:a.media,image:d,title:n.course.name}),b.a.createElement("div",{className:a.details},b.a.createElement(R.a,{variant:"body1",className:a.subheading},n.course.description,b.a.createElement("br",null)))),b.a.createElement(yt.a,null),b.a.createElement("div",null,b.a.createElement(zt.a,{title:b.a.createElement(R.a,{variant:"h6",className:a.subheading},"Lessons"),subheader:b.a.createElement(R.a,{variant:"body1",className:a.subheading},n.course.lessons&&n.course.lessons.length," lessons"),action:(null===(t=r.user)||void 0===t?void 0:t._id)==n.course.instructor._id&&b.a.createElement("span",{className:a.action})}),b.a.createElement(Ce.a,null,n.course.lessons&&n.course.lessons.map((e,t)=>b.a.createElement("span",{key:t},b.a.createElement(Te.a,null,b.a.createElement(qe.a,null,b.a.createElement(Pe.a,null,t+1)),b.a.createElement(Le.a,{primary:e.title})),b.a.createElement(yt.a,{variant:"inset",component:"li"})))))),-1!=s.drawer&&b.a.createElement(b.a.Fragment,null,b.a.createElement(R.a,{variant:"h5",className:a.heading},n.course.name),b.a.createElement(Y.a,{className:a.card},b.a.createElement(zt.a,{title:n.course.lessons[s.drawer].title,action:b.a.createElement(W.a,{onClick:()=>{if(!n.lessonStatus[s.drawer].complete){const{lessonStatus:t}=n;t[s.drawer].complete=!0;let a=m(t),l={};l.lessonStatusId=t[s.drawer]._id,l.complete=!0,a==t.length&&(l.courseCompleted=Date.now()),(async(e,t)=>{console.log("Raehinc");try{let a=await fetch("/api/enrollment/complete/"+e.enrollmentId,{method:"PUT",headers:{Accept:"application/json","Content-Type":"application/json",Authorization:"Bearer "+e.token},body:JSON.stringify(t)});return await a.json()}catch(e){console.log(e)}})({enrollmentId:e.params.enrollmentId,token:r.token},l).then(e=>{e&&e.error?c({...s,error:e.error}):o({...n,lessonStatus:t})})}},variant:n.lessonStatus[s.drawer].complete?"contained":"outlined",color:"secondary"},n.lessonStatus[s.drawer].complete?"Completed":"Mark as complete")}),b.a.createElement(da.CardContent,null,b.a.createElement(R.a,{variant:"body1",className:a.para},n.course.lessons[s.drawer].content)),b.a.createElement(Ge.a,null,b.a.createElement("a",{href:n.course.lessons[s.drawer].resource_url},b.a.createElement(W.a,{variant:"contained",color:"primary"},"Resource Link"))))))};var ha=()=>b.a.createElement(b.a.Fragment,null,b.a.createElement(H,null),b.a.createElement(S.Switch,null,b.a.createElement(S.Route,{exact:!0,path:"/",component:we}),b.a.createElement(S.Route,{exact:!0,path:"/users",component:We}),b.a.createElement(S.Route,{exact:!0,path:"/signup",component:mt}),b.a.createElement(S.Route,{exact:!0,path:"/signin",component:gt}),b.a.createElement(I,{path:"/user/edit/:userId",component:Pt}),b.a.createElement(S.Route,{exact:!0,path:"/user/:userId",component:qt}),b.a.createElement(I,{exact:!0,path:"/teach/courses",component:Dt}),b.a.createElement(I,{exact:!0,path:"/teach/course/new",component:Tt}),b.a.createElement(I,{exact:!0,path:"/teach/course/edit/:courseId",component:Zt}),b.a.createElement(I,{exact:!0,path:"/course/:courseId",component:Yt}),b.a.createElement(I,{exact:!0,path:"/learn/:enrollmentId",component:ga}),b.a.createElement(S.Route,{render:()=>b.a.createElement(S.Redirect,{to:"/"})}))),Ea=a(45),fa=a(70);var ya=Object(J.createMuiTheme)({typography:{useNextVariants:!0},palette:{primary:{light:"#5c67a3",main:"#3f4771",dark:"#2e355b",contrastText:"#fff"},secondary:{light:"#ff79b0",main:"#ff4081",dark:"#c60055",contrastText:"#000"},openTitle:"#3f4771",protectedTitle:fa.pink[400],type:"light"}}),ba=a(7),xa=a.n(ba),va=a(71),wa=a.n(va);const ja=new xa.a.Schema({name:{type:String,trim:!0,required:"Name is required"},educator:{type:Boolean,default:!1},email:{type:String,trim:!0,unique:"Email already exists",match:[/.+\@.+\..+/,"Please fill a valid email address"],required:"Email is required"},hashed_password:{type:String,required:"Password is required"},salt:String,updated:Date,created:{type:Date,default:Date.now}});ja.virtual("password").set((function(e){this._password=e,this.salt=this.makeSalt(),this.hashed_password=this.encryptPassword(e)})).get((function(){return this._password})),ja.path("hashed_password").validate((function(e){this._password&&this._password.length<6&&(this.invalidate("password","Password must be at least 6 characters."),this.isNew&&!this._password&&this.invalidate("password","Password is required"))}),null),ja.methods={authenticate:function(e){return this.encryptPassword(e)===this.hashed_password},encryptPassword:function(e){if(!e)return"";try{return wa.a.createHmac("sha1",this.salt).update(e).digest("hex")}catch(e){return""}},makeSalt:function(){return Math.round((new Date).valueOf()*Math.random())+""}};var Sa=xa.a.model("User",ja),ka=a(39),Ca=a.n(ka);var Na=e=>{let t="";if(e.code)switch(e.code){case 11e3:case 11001:t=(e=>{let t;try{let a=e.message.substring(e.message.lastIndexOf(".$")+2,e.message.lastIndexOf("_1"));t=a.charAt(0).toUpperCase()+a.slice(1)+" already exists"}catch(e){t="Unique field already exists"}return t})(e);break;default:t="Something went wrong"}else for(let a in e.errors)e.errors[a].message&&(t=e.errors[a].message);return t};var Ta=async(e,t)=>{const a=new Sa(e.body);try{return await a.save(),t.status(200).json({message:"Successfully signed up!"})}catch(e){return t.status(400).json({error:Na(e)})}},Ia=async(e,t,a,r)=>{try{let n=await Sa.findById(r);if(!n)return t.status(400).json({error:"User Not Found"});e.profile=n,a()}catch(e){return t.status(400).json({error:"Could not retrieve user"})}},qa=(e,t)=>(e.profile.hashed_password=void 0,e.profile.salt=void 0,t.json(e.profile)),_a=async(e,t)=>{try{let e=await Sa.find().select("name email updated created");return t.status(200).json(e)}catch(e){return t.status(400).json({error:Na(e)})}},Oa=async(e,t)=>{try{let a=e.profile,r=await a.remove();r.hashed_password=void 0,r.salt=void 0,t.json(r)}catch(e){return t.status(400).json({error:Na(e)})}},Aa=async(e,t)=>{try{let a=e.profile;a=Ca()(a,e.body),a.updated=Date.now(),await a.save(),a.hashed_password=void 0,a.salt=void 0,a.image=void 0,t.json(a)}catch(e){return t.status(400).json({error:Na(e)})}},La=async(e,t,a)=>{try{var r;if(!(null===(r=e.profile)||void 0===r?void 0:r.educator))return t.status(403).json({error:"User is not an Educator"});a()}catch(e){return t.status(400).json({error:"Something went wrong here"})}},Ra=a(72),Pa=a.n(Ra),Ba=a(73),Da=a.n(Ba);var Fa={signin:async function(e,t){console.log("Reaching");try{let a=await Sa.findOne({email:e.body.email});if(!a)return t.status(401).json({error:"User Not Found!!!"});if(!a.authenticate(e.body.password))return t.status(401).json({error:"Password don't match"});const n=Da.a.sign({_id:a._id},r.jwtSecret);return t.cookie("t",n,{expire:new Date+9999}),t.status(200).json({token:n,user:{_id:a._id,name:a.name,email:a.email,educator:a.educator}})}catch(e){return t.status(401).json({error:"Could not sign in"})}},signout:function(e,t){return console.log("Reaching"),t.clearCookie("t"),t.status(200).json({message:"Signed out"})},requireSignin:Pa()({secret:r.jwtSecret,userProperty:"auth",algorithms:["HS256"]}),hasAuthorization:function(e,t,a){if(!(e.profile&&e.auth&&e.profile._id==e.auth._id))return t.status(403).json({error:"User is not authorized to perform this action"});a()}};const za=i.a.Router();za.route("/api/user").get(_a).post(Ta),za.route("/api/user/:userId").get(Fa.requireSignin,qa).put(Fa.requireSignin,Fa.hasAuthorization,Aa).delete(Fa.requireSignin,Fa.hasAuthorization,Oa),za.param("userId",Ia);var Ua=za;const $a=i.a.Router();$a.route("/auth/signin").post(Fa.signin),$a.route("/auth/signout").get(Fa.signout);var Wa=$a;const Ma=new xa.a.Schema({title:String,content:String,resource_url:String}),Ga=(xa.a.model("Lesson",Ma),new xa.a.Schema({name:{type:String,trim:!0,required:"Name is required"},description:{type:String,trim:!0},lessons:[Ma],image:{data:Buffer,contentType:String},category:{type:String,required:"Category is required"},published:{type:Boolean,default:!1},instructor:{type:xa.a.Schema.ObjectId,ref:"User"},updated:Date,created:{type:Date,default:Date.now}}));var Ha=xa.a.model("Course",Ga),Ja=a(46),Va=a.n(Ja),Ya=a(47),Xa=a.n(Ya),Ka=a.p+"b5e188c92802e96faa6f2b04d236ebb2.png";var Qa=(e,t)=>{let a=new Xa.a.IncomingForm;a.keepExtensions=!0,a.parse(e,async(a,r,n)=>{if(a)return t.status(400).json({error:"Image could not be uploaded"});let o=new Ha(r);o.instructor=e.profile,n.image&&(o.image.data=Va.a.readFileSync(n.image.path),o.image.contentType=n.image.type);try{let e=await o.save();t.json(e)}catch(a){return t.status(400).json({error:Na(a)})}})},Za=(e,t)=>{Ha.find({instructor:e.profile._id},(e,a)=>{if(e)return t.status(400).json({error:Na(e)});t.json(a)}).populate("instructor","_id name")},er=(e,t)=>(e.course.image=void 0,t.json(e.course)),tr=(e,t,a)=>{var r,n;if(!((null===(r=e.course.instructor)||void 0===r?void 0:r._id)==(null===(n=e.auth)||void 0===n?void 0:n._id)))return t.status("403").json({error:"User is not authorized"});a()},ar=async(e,t)=>{try{let a=e.course,r=await a.remove();t.json(r)}catch(e){return t.status(400).json({error:Na(e)})}},rr=(e,t,a)=>{if(e.course.image.data)return t.set("Content-Type",e.course.image.contentType),t.send(e.course.image.data);a()},nr=(e,t)=>t.sendFile(process.cwd()+Ka),or=async(e,t,a,r)=>{try{let n=await Ha.findById(r).populate("instructor","_id name");if(!n)return t.status(401).json({error:"Course does not Exist"});e.course=n,a()}catch(e){return t.status(400).json({error:"Could Not Retrieve Course"})}},lr=async(e,t)=>{try{let{lesson:a}=e.body,r=await Ha.findByIdAndUpdate(e.course._id,{$push:{lessons:a},updated:Date.now()},{new:!0}).populate("instructor","_id name").exec();t.json(r)}catch(e){return t.status(400).json({error:Na(e)})}},ir=async(e,t)=>{let a=new Xa.a.IncomingForm;a.keepExtensions=!0,a.parse(e,async(a,r,n)=>{if(a)return t.status(400).json({error:"Photo could not be uploaded"});let o=e.course;o=Ca()(o,r),r.lessons&&(o.lessons=JSON.parse(r.lessons)),o.updated=Date.now(),n.image&&(o.image.data=Va.a.readFileSync(n.image.path),o.image.contentType=n.image.type);try{await o.save(),t.json(o)}catch(a){return t.status(400).json({error:Na(a)})}})},sr=(e,t)=>{Ha.find({published:!0},(e,a)=>{if(e)return t.status(400).json({error:Na(e)});t.json(a)}).populate("instructor","_id name")};const cr=i.a.Router();cr.route("/api/courses/photo/:courseId").get(rr,nr),cr.route("/api/courses/defaultphoto").get(nr),cr.route("/api/courses/by/:userId").post(Fa.requireSignin,Fa.hasAuthorization,La,Qa).get(Fa.requireSignin,Fa.hasAuthorization,Za),cr.route("/api/courses/published").get(sr),cr.route("/api/courses/:courseId").get(er).put(Fa.requireSignin,tr,ir).delete(Fa.requireSignin,tr,ar),cr.route("/api/courses/:courseId/lesson/new").put(Fa.requireSignin,tr,lr),cr.param("userId",Ia),cr.param("courseId",or);var ur=cr;const mr=new xa.a.Schema({course:{type:xa.a.Schema.ObjectId,ref:"Course"},student:{type:xa.a.Schema.ObjectId,ref:"User"},lessonStatus:[{lesson:{type:xa.a.Schema.ObjectId,ref:"Lesson"},complete:Boolean}],enrolled:{type:Date,default:Date.now},updated:Date,completed:Date});var dr=xa.a.model("Enrollment",mr);var pr=async(e,t,a)=>{try{let r=await dr.find({course:e.course._id,student:e.auth._id});0==r.length?a():t.json(r[0])}catch(e){return t.status(400).json({error:Na(e)})}},gr=async(e,t)=>{let a={course:e.course,student:e.auth};a.lessonStatus=e.course.lessons.map(e=>({lesson:e,complete:!1}));const r=new dr(a);try{let e=await r.save();return t.status(200).json(e)}catch(e){return t.status(400).json({error:Na(e)})}},hr=(e,t)=>t.json(e.enrollment),Er=async(e,t)=>{try{const a=await dr.find({student:e.auth._id}).sort({completed:1}).populate("course","_id name category");t.json(a)}catch(e){return console.log(e),t.status(400).json({error:Na(e)})}},fr=async(e,t,a,r)=>{try{let n=await dr.findById(r).populate({path:"course",populate:{path:"instructor"}}).populate("student","_id name");if(!n)return t.status("400").json({error:"Enrollment not found"});e.enrollment=n,a()}catch(e){return console.log("Erroe",e),t.status("400").json({error:"Could not retrieve enrollment"})}},yr=(e,t,a)=>{var r;if(!((null===(r=e.auth)||void 0===r?void 0:r._id)==e.enrollment.student._id))return t.status(403).json({error:"User is not enrolled"});a()},br=async(e,t)=>{let a={};a["lessonStatus.$.complete"]=e.body.complete,a.updated=Date.now(),e.body.courseCompleted&&(a.completed=e.body.courseCompleted);try{let r=await dr.updateOne({"lessonStatus._id":e.body.lessonStatusId},{$set:a});t.json(r)}catch(e){return t.status(400).json({error:Na(e)})}};const xr=i.a.Router();xr.route("/api/enrollment/new/:courseId").post(Fa.requireSignin,pr,gr),xr.route("/api/enrollment/enrolled").get(Fa.requireSignin,Er),xr.route("/api/enrollment/:enrollmentId").get(Fa.requireSignin,yr,hr),xr.route("/api/enrollment/complete/:enrollmentId").put(Fa.requireSignin,yr,br),xr.param("courseId",or),xr.param("enrollmentId",fr);var vr=xr;const wr=i()(),jr=process.cwd();IAcfdYhHX3Ixjh0u,wr.use(c.a.json()),wr.use(c.a.urlencoded({extended:!0})),wr.use(m()()),wr.use(p()()),wr.use(f()()),wr.use(h()()),wr.use("/",vr),wr.use("/",Ua),wr.use("/",Wa),wr.use("/",ur),wr.use("/dist",i.a.static(o.a.join(jr,"dist"))),wr.get("*",(e,t)=>{const a=new Ea.ServerStyleSheets,r={},n=v.a.renderToString(a.collect(b.a.createElement(j.a,{location:e.url,context:r},b.a.createElement(Ea.ThemeProvider,{theme:ya},b.a.createElement(ha,null)))));if(r.url)return t.redirect(303,r.url);const o=a.toString();t.status(200).send((({markup:e,css:t})=>`<!doctype html>\n    <html lang="en">\n    <head>\n        <meta charset="utf-8">\n        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:100,300,400">\n        <link href="https://fonts.googleapis.com/icon?family=Material+Icons"\n        rel="stylesheet">\n    <title>MERN Skeleton</title>\n    </head>\n    <body>\n    <div id="root">${e}</div>\n    <style id="jss-server-side" >${t}</style>\n    <script type="text/javascript" src="/dist/bundle.js"><\/script>\n    </body>\n    </html>`)({markup:n,css:o}))}),wr.use((e,t,a,r)=>{"UnauthorizedError"===e.name?a.status(401).json({error:e.name+": "+e.message}):e&&a.status(400).json({error:e.name+": "+e.message})});var Sr=wr;xa.a.Promise=global.Promise,xa.a.connect(r.mongoUri,{useCreateIndex:!0,useUnifiedTopology:!0,useNewUrlParser:!0,useFindAndModify:!1}),xa.a.connection.on("error",()=>{throw new Error("unable to connect to database: "+r.mongoUri)}),Sr.listen(r.PORT,e=>{e&&console.log(e),console.info("Server started on port %s",r.PORT)})}]);